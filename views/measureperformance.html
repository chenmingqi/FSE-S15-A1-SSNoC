<!DOCTYPE html>
<html>
<head>
   <title>Survivable Social Network on a Chip</title>
   <link href="/css/bootstrap.min.css" rel="stylesheet">
   <link href="/css/signin.css" rel="stylesheet">
   <script src="/js/jquery-1.11.2.min.js"></script>
   <script src="/js/bootstrap.min.js"></script>
</head>
<body>

   <!-- Header -->
  <div class="row-fluid">
    <div class="span12">
    <div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
    <a class="navbar-brand" href="#">Measure Performance</a>
    <div id="navbar" class="navbar-collapse collapse">
    <ul class="nav navbar-nav navbar-right">
    <li><a href='/home'>Back&nbsp;&nbsp;&nbsp;</a></li>
    <li><a href="/logout">Log out&nbsp;&nbsp;&nbsp;</a></li>
    </ul>
    </div>
    </div>
    </div>
    </div>
  </div>
 <input style="visibility:hidden;" value="<%= login_user.username %>" id="username">
  <br>

  <% if(typeof message != "undefined") {%>
  <div style="width: 700px; margin: 5px auto; border: 1px solid #999; padding: 0 20px;  border-radius:10px;">
      <h4 id="message" style="color:red"><%= message %></h4>
  </div>
  <% } %>

  <form class="form-signin" action="" method="post">
    <h4 class="form-signin-heading">Please enter time duration (1-5)</h2>
    <input type="username" name="words" class="form-control" placeholder="1-5" required autofocus>
    <br>
    <button id="test" class="btn btn-lg btn-primary btn-block" type="submit" value="Submit">Submit</button>
  </form>

  <div id="message_div" style="margin-bottom:100px;">
    <ul id="messages"></ul>
  </div>

</body>
    <script src="js/jquery-1.11.2.min.js"></script>
    <script src="js/socket.io-1.2.0.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/modernizr-2.6.1-respond-1.1.0.min.js"></script>
    <script>
    $(document).ready(function() {
      var socket = io();
      var timeflag = true;

      $('#test').click(function(e){
        e.preventDefault();
        var stopsending=setTimeout(function(){
          timeflag = false;
          socket.emit('empty test database and get result');
          alert("time up!");
        },2000);
        socket.emit('measure performance', [$('#username').val(), "Measure Performance!"]);
      });



      socket.on('measure performance', function(data){
        if( timeflag ){
          socket.emit('measure performance', [$('#username').val(), "Measure Performance!"]);
          $('#messages').append($('<li>').text(data[2] + ", " + data[0] + ":"));
          $('#messages').append($('<li>').text(data[1]));
        }
      });

      socket.on('empty test database and get result',function(message_num){
        alert(message_num);
      });

    });

    </script>

</html>
